{
  "name": "mattkonnect/bloc-contact-multi",
  "title": "Bloc Contact Multi-Permanence (avec reCAPTCHA + fallback)",
  "description": "Formulaire de contact avec sélection de permanence, Google reCAPTCHA v3, message visuel et fallback sans JS.",
  "categories": ["form", "contact", "sections"],
  "viewportWidth": 1000,
  "content": "<!-- wp:group {\"style\":{\"spacing\":{\"padding\":{\"top\":\"60px\",\"bottom\":\"60px\"}}},\"backgroundColor\":\"neutral-light\",\"layout\":{\"type\":\"constrained\"}} -->\\n<div class=\\\"wp-block-group has-neutral-light-background-color has-background\\\" style=\\\"padding-top:60px;padding-bottom:60px\\\">\\n\\n<!-- wp:heading {\\\"level\\\":2} -->\\n<h2 class=\\\"wp-block-heading\\\">Contacter la Mission Locale</h2>\\n<!-- /wp:heading -->\\n\\n<!-- wp:html -->\\n<form id=\\\"contact-form\\\" action=\\\"/wp-admin/admin-post.php\\\" method=\\\"POST\\\">\\n  <input type=\\\"hidden\\\" name=\\\"action\\\" value=\\\"mk_contact_form\\\">\\n\\n  <!-- Antispam (honeypot) -->\\n  <input type=\\\"text\\\" name=\\\"website\\\" style=\\\"display:none\\\" tabindex=\\\"-1\\\" autocomplete=\\\"off\\\">\\n\\n  <p><label for=\\\"name\\\">Nom :</label><br><input type=\\\"text\\\" id=\\\"name\\\" name=\\\"name\\\" required></p>\\n  <p><label for=\\\"email\\\">Email :</label><br><input type=\\\"email\\\" id=\\\"email\\\" name=\\\"email\\\" required></p>\\n  <p><label for=\\\"permanence\\\">Choisir une permanence :</label><br>\\n    <select id=\\\"permanence\\\" name=\\\"permanence\\\" required>\\n      <option value=\\\"centre\\\">Centre-ville</option>\\n      <option value=\\\"est\\\">Quartier Est</option>\\n      <option value=\\\"autre\\\">Autre</option>\\n    </select>\\n  </p>\\n  <p><label for=\\\"message\\\">Votre message :</label><br><textarea id=\\\"message\\\" name=\\\"message\\\" rows=\\\"5\\\" required></textarea></p>\\n\\n  <div id=\\\"form-status\\\" style=\\\"margin-top:1rem;font-weight:bold;color:#E30613\\\"></div>\\n\\n  <input type=\\\"submit\\\" value=\\\"Envoyer\\\">\\n</form>\\n\\n<noscript>\\n  <p><strong>Note :</strong> Le formulaire fonctionne sans JavaScript mais sans validation avancée.</p>\\n  <!-- Affichage message si redirection -->\\n  <script>document.addEventListener('DOMContentLoaded', function() {\\n    const status = new URLSearchParams(window.location.search).get('status');\\n    const statusDiv = document.getElementById('form-status');\\n    if (status === 'success') statusDiv.textContent = '✅ Message envoyé avec succès';\\n    if (status === 'error') statusDiv.textContent = '❌ Veuillez remplir tous les champs';\\n    if (status === 'spam') statusDiv.textContent = '⚠️ Requête bloquée';\\n  });</script>\\n</noscript>\\n\\n<script src=\\\"https://www.google.com/recaptcha/api.js?render=YOUR_SITE_KEY\\\"></script>\\n<script>\\n  const form = document.getElementById('contact-form');\\n  const statusDiv = document.getElementById('form-status');\\n  grecaptcha.ready(function () {\\n    form.addEventListener('submit', function (e) {\\n      e.preventDefault();\\n      grecaptcha.execute('YOUR_SITE_KEY', { action: 'submit' }).then(function (token) {\\n        const formData = new FormData(form);\\n        formData.append('g-recaptcha-response', token);\\n\\n        fetch('/wp-admin/admin-post.php', {\\n          method: 'POST',\\n          body: formData\\n        })\\n        .then(response => {\\n          if (response.ok) {\\n            statusDiv.textContent = '✅ Message envoyé avec succès !';\\n            form.reset();\\n          } else {\\n            statusDiv.textContent = '❌ Une erreur est survenue. Veuillez réessayer.';\\n          }\\n        })\\n        .catch(error => {\\n          console.error(error);\\n          statusDiv.textContent = '❌ Erreur réseau ou serveur.';\\n        });\\n      });\\n    });\\n  });\\n</script>\\n<!-- /wp:html -->\\n\\n</div>\\n<!-- /wp:group -->"
}
